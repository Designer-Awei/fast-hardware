# 项目文件夹结构说明

这个目录包含所有用户创建的硬件项目。每个项目都是一个独立的文件夹，采用简化的三文件结构。

## 📁 简化项目结构

每个项目文件夹包含以下核心文件（简化设计，去除冗余）：

```
项目名称/
├── components/              # 项目级元件库
│   ├── 元件1.json          # 单个元件定义文件
│   ├── 元件2.json          # （从系统级元件库复制或LLM生成）
│   └── ...
├── circuit_config.json     # 电路系统配置（包含项目元数据）
└── generated_code.ino      # 生成的固件代码
```

**📝 结构优化说明**:
- **简化设计**: 移除`metadata.json`和`README.md`，避免信息重复
- **元数据整合**: 项目基本信息统一记录在`circuit_config.json`中
- **专注核心**: 只保留电路设计和代码生成的必要文件

## 📋 文件说明

### 1. components/ 文件夹
- **用途**: 存储项目使用的所有元件定义
- **来源**: 
  - 从系统级元件库(`data/system-components/`)复制
  - LLM根据需求生成的新元件
- **特点**: 项目级独立副本，可以针对项目进行定制

### 2. circuit_config.json
- **用途**: 电路系统配置文件（包含完整的项目信息）
- **内容**:
  - **项目元数据**: 名称、描述、创建时间、修改时间、版本
  - **元件实例**: 位置、朝向、属性、自定义标签
  - **连接关系**: 引脚连接、路径、样式、连接类型
  - **画布设置**: 缩放、平移、网格显示等
  - **代码生成信息**: 固件代码的文件名和生成时间

#### 📋 接线配置标准格式

**引脚标识格式**: `边名-序号` (例如: `side1-1`, `side3-2`)

```json
{
  "connections": [
    {
      "id": "wire-001",
      "source": {
        "instanceId": "arduino-1",
        "pinId": "side1-12"  // 引脚边和序号 (GND引脚)
      },
      "target": {
        "instanceId": "led-1",
        "pinId": "side3-3"   // LED负极引脚
      },
      "wireType": "ground", // digital, analog, power, ground
      "description": "LED接地连接",
      "routingPoints": [
        [200, 180],
        [350, 180],
        [350, 130]
      ],
      "style": {
        "thickness": 2,
        "dashPattern": []
      }
    }
  ]
}
```

**引脚ID格式说明**:
- `side1`: 上边引脚 (通常数字1-15)
- `side2`: 右边引脚 (通常数字1-15)
- `side3`: 下边引脚 (通常数字1-15)
- `side4`: 左边引脚 (通常数字1-15)
- **序号**: 从左到右的引脚顺序号 (从1开始)

**线条样式** (简化版):
- 移除颜色参数，使用系统默认颜色
- 保持粗细和虚线样式
- 系统根据连接类型自动设置颜色

### 3. 固件代码文件 (*.ino)
- **用途**: LLM生成的Arduino代码
- **特点**: 
  - 包含完整的功能实现
  - 详细的中文注释
  - 基于circuit_config.json的连接关系

## 🔄 项目生命周期

### 1. 项目创建
```
用户输入需求 → LLM分析 → 选择自定义元件 → 生成项目文件夹 → 复制/生成元件 → 生成电路配置 → 生成代码
```

### 2. 项目编辑
```
用户修改连线 → 手动调整元件 → 保存(Ctrl+S) → 更新circuit_config.json → 可选择重新生成代码
```

### 3. 项目导出
```
打包整个项目文件夹 → 包含所有依赖的元件 → 可在其他设备导入
```

## 🎯 最佳实践

1. **项目命名**: 使用描述性的英文名称，避免特殊字符
2. **版本管理**: 重要修改时更新circuit_config.json中的版本号
3. **信息维护**: 及时更新circuit_config.json中的项目描述和修改时间
4. **备份习惯**: 定期备份重要项目

## ⚠️ 注意事项

- 不要手动编辑components/文件夹中的元件文件
- circuit_config.json是项目的核心文件，包含所有项目信息，谨慎修改
- 代码文件可以手动编辑，但重新生成会覆盖修改
- 项目结构已简化，新增项目将自动采用新的三文件结构
